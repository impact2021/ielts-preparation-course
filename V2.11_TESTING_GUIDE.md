# Version 2.11 Testing Guide

## Overview
This guide provides step-by-step instructions for testing all new features in version 2.11 of the IELTS Course Manager plugin.

## Prerequisites
- WordPress installation with IELTS Course Manager v2.11 installed
- Admin access to WordPress
- At least 3 courses created
- At least 6 lessons created and assigned to courses
- At least 6 sublessons created
- At least 6 exercises created

## Test 1: Collapsible Questions in Exercise Editor

### Objective
Verify that questions in the exercise editor collapse by default and can be expanded/collapsed.

### Steps
1. Navigate to **IELTS Courses > Exercises**
2. Click **Edit** on an existing exercise with multiple questions (or create one with 3+ questions)
3. **Expected:** All questions should be collapsed by default
   - Only question headers visible (e.g., "Question 1", "Question 2")
   - Caret icon pointing right (→)
4. Click on "Question 1" header
5. **Expected:** Question 1 expands smoothly
   - Content slides down
   - Caret icon points down (↓)
6. Click on "Question 1" header again
7. **Expected:** Question 1 collapses
   - Content slides up
   - Caret icon points right (→)
8. Expand Question 1, then expand Question 2
9. **Expected:** Both questions can be expanded simultaneously
10. Click "Add Question" button
11. **Expected:** New question is added and automatically expanded
12. Save the exercise
13. Reload the page
14. **Expected:** All questions are collapsed again

### Pass Criteria
- ✅ Questions collapse by default on page load
- ✅ Caret icon rotates when expanding/collapsing
- ✅ Smooth animation for expand/collapse
- ✅ Multiple questions can be expanded simultaneously
- ✅ New questions are added in expanded state
- ✅ State doesn't persist after page reload (all collapsed)

---

## Test 2: Drag and Drop Questions

### Objective
Verify that questions can be reordered by dragging and dropping.

### Steps
1. Navigate to an exercise with 3+ questions
2. Expand all questions to see their content
3. Hover over the drag handle (☰ icon) on Question 1
4. **Expected:** Cursor changes to move cursor
5. Click and hold on the drag handle
6. Drag Question 1 to the position of Question 3
7. **Expected:** 
   - Placeholder appears showing drop position
   - Other questions shift to make room
8. Release the mouse button
9. **Expected:**
   - Question order updates: "Question 1", "Question 2", "Question 3" become "Question 2", "Question 3", "Question 1"
   - Question numbers update automatically
10. Save the exercise
11. Reload the page
12. **Expected:** Question order is preserved

### Pass Criteria
- ✅ Drag handle visible and functional
- ✅ Visual feedback during drag
- ✅ Question numbers update after drop
- ✅ Order persists after save
- ✅ No errors in browser console

---

## Test 3: Course-Based Lesson Filtering in Exercise Editor

### Objective
Verify that the "Assign to Lessons" dropdown filters based on selected courses.

### Setup
- Ensure you have:
  - Course A with Lessons 1, 2, 3
  - Course B with Lessons 4, 5, 6
  - An exercise to test with

### Steps
1. Navigate to **IELTS Courses > Exercises**
2. Click **Edit** on the test exercise
3. Scroll to "Assign to Courses" field
4. **Initial state:** Select no courses
5. Check "Assign to Lessons (Optional)" dropdown
6. **Expected:** All lessons (1-6) are visible
7. Select **Course A** in "Assign to Courses"
8. **Expected:** 
   - Loading spinner appears briefly
   - "Assign to Lessons" dropdown updates
   - Only Lessons 1, 2, 3 are visible
9. Select **Lesson 1** and **Lesson 2** (hold Ctrl/Cmd)
10. Now also select **Course B** (hold Ctrl/Cmd)
11. **Expected:**
   - Loading spinner appears
   - Lessons 1, 2, 3, 4, 5, 6 are now visible
   - Lessons 1 and 2 remain selected
12. Deselect **Course A** (only Course B selected)
13. **Expected:**
   - Only Lessons 4, 5, 6 visible
   - Previously selected Lessons 1, 2 are cleared (not in available list)
14. Deselect all courses
15. **Expected:** All lessons (1-6) visible again
16. Select a course and some lessons, then save
17. Reload the page
18. **Expected:** Filtered lessons still match selected courses

### Pass Criteria
- ✅ All lessons visible when no courses selected
- ✅ Filtering works for single course
- ✅ Filtering works for multiple courses
- ✅ Selected lessons maintained when adding courses
- ✅ Selected lessons cleared when no longer in filter
- ✅ Loading indicator shows during AJAX
- ✅ No JavaScript errors

---

## Test 4: Add and Remove Lessons from Courses

### Objective
Verify the ability to add and remove lessons from a course using the enhanced UI.

### Steps

#### Part A: Add Lesson to Course
1. Navigate to **IELTS Courses > Courses**
2. Click **Edit** on any course
3. Scroll to "Course Lessons" meta box
4. **Expected:** See two sections:
   - "Add Lessons to Course" (top)
   - "Course Lessons" (bottom, if any lessons exist)
5. In the search box, type a lesson name (e.g., "Reading")
6. **Expected:** Dropdown filters in real-time
7. Select a lesson from the dropdown
8. Click "Add Selected Lesson" button
9. **Expected:**
   - Success message appears
   - Lesson appears in "Course Lessons" list below
   - Lesson is removed from the add selector
10. Try searching again - the added lesson should not appear
11. Save the course
12. Reload the page
13. **Expected:** Added lesson still appears in course lessons list

#### Part B: Remove Lesson from Course
1. In the same course, find a lesson in "Course Lessons" list
2. Click the "Remove" button next to the lesson
3. **Expected:** Confirmation dialog appears
4. Click "Cancel" in dialog
5. **Expected:** Lesson remains in list
6. Click "Remove" button again
7. Click "OK" in confirmation dialog
8. **Expected:**
   - Success message appears
   - Lesson is removed from "Course Lessons" list
   - Lesson appears back in "Add Lessons" selector
9. Save the course
10. Reload the page
11. **Expected:** Removed lesson is not in course lessons list

### Pass Criteria
- ✅ Search filters lessons in real-time
- ✅ Can add lesson to course
- ✅ Added lesson appears in course list
- ✅ Added lesson removed from selector
- ✅ Confirmation dialog works
- ✅ Can cancel removal
- ✅ Can confirm removal
- ✅ Removed lesson returns to selector
- ✅ Changes persist after save
- ✅ Success/error messages display correctly

---

## Test 5: Add and Remove Content from Lessons

### Objective
Verify the ability to add and remove sublessons and exercises from a lesson.

### Steps

#### Part A: Add Sublesson to Lesson
1. Navigate to **IELTS Courses > Lessons**
2. Click **Edit** on any lesson
3. Scroll to "Lesson Content (Pages & Exercises)" meta box
4. **Expected:** See:
   - Content type selector (Sub Lessons / Exercises)
   - Search box
   - Selector dropdown
   - "Add Selected Content" button
5. Ensure "Sub Lessons" radio is selected
6. Type in search box
7. **Expected:** Dropdown filters sublessons
8. Select a sublesson
9. Click "Add Selected Content"
10. **Expected:**
    - Success message
    - Sublesson appears in "Lesson Content" list
    - Badge shows "Page"
    - Removed from selector

#### Part B: Add Exercise to Lesson
1. In same lesson, click "Exercises" radio button
2. **Expected:** 
   - Loading happens
   - Selector updates to show exercises
3. Search for an exercise
4. Select and add it
5. **Expected:**
   - Exercise appears in "Lesson Content" list
   - Badge shows "Exercise"

#### Part C: Remove Content from Lesson
1. In "Lesson Content" list, find a sublesson
2. Click "Remove" button
3. **Expected:** Confirmation dialog
4. Click "OK"
5. **Expected:**
   - Sublesson removed from list
   - Returns to selector (if "Sub Lessons" radio is active)
6. Click "Exercises" radio
7. Find an exercise in content list
8. Remove it
9. **Expected:** Exercise removed and returns to exercises selector

### Pass Criteria
- ✅ Radio selector switches content types
- ✅ Search filters work for both types
- ✅ Can add sublessons
- ✅ Can add exercises
- ✅ Badges show correct type (Page/Exercise)
- ✅ Removed content returns to selector
- ✅ Content type selector switches correctly
- ✅ No page reload when switching types
- ✅ Changes persist after save

---

## Test 6: Drag and Drop Lesson Content

### Objective
Verify that lesson content (pages and exercises) can be reordered.

### Steps
1. Edit a lesson with both sublessons and exercises
2. Note the initial order
3. Drag a sublesson to a new position
4. **Expected:** Order updates, items renumber
5. Drag an exercise between two sublessons
6. **Expected:** Mixed ordering works
7. Save the lesson
8. Reload the page
9. **Expected:** Order is preserved

### Pass Criteria
- ✅ Can drag both sublessons and exercises
- ✅ Can mix order of different types
- ✅ Visual feedback during drag
- ✅ Order numbers update
- ✅ Changes persist

---

## Test 7: Security and Permissions

### Objective
Verify that security measures are working.

### Steps
1. Log in as an **Editor** user
2. Navigate to edit a course
3. Try to add/remove lessons
4. **Expected:** Should work (editors can edit posts)
5. Log out and log in as a **Subscriber** user
6. Try to access course edit page
7. **Expected:** Access denied or limited functionality
8. Try to make direct AJAX calls without proper nonce (use browser console):
   ```javascript
   jQuery.post(ajaxurl, {action: 'ielts_cm_add_lesson_to_course', course_id: 1, lesson_id: 1});
   ```
9. **Expected:** Security check failed message

### Pass Criteria
- ✅ Proper user capabilities enforced
- ✅ Nonce verification works
- ✅ Unauthorized users cannot make changes
- ✅ No security warnings in browser console

---

## Test 8: Browser Compatibility

### Objective
Verify features work across browsers.

### Browsers to Test
- Chrome/Edge (latest)
- Firefox (latest)
- Safari (latest)
- Mobile Safari (iOS)
- Mobile Chrome (Android)

### Quick Test Checklist per Browser
1. Expand/collapse questions
2. Drag and drop questions
3. Add lesson to course
4. Remove lesson from course
5. Switch content types in lesson
6. Search functionality

### Pass Criteria
- ✅ All features work in all browsers
- ✅ No layout issues
- ✅ No JavaScript errors
- ✅ Touch events work on mobile

---

## Test 9: Performance

### Objective
Verify that new features don't impact performance.

### Steps
1. Create an exercise with 50+ questions
2. Edit the exercise
3. **Expected:** Page loads in reasonable time
4. Expand/collapse several questions
5. **Expected:** Smooth animations, no lag
6. Create a course with 30+ lessons
7. Edit the course
8. **Expected:** Search and add still responsive
9. Check browser console for any warnings
10. Use browser dev tools to check:
    - Network requests (should be minimal)
    - Memory usage (should be reasonable)

### Pass Criteria
- ✅ No significant performance degradation
- ✅ AJAX calls complete in < 2 seconds
- ✅ UI remains responsive
- ✅ No memory leaks

---

## Test 10: Edge Cases

### Objective
Test unusual but valid scenarios.

### Test Cases

#### Empty States
1. Edit a course with no lessons
   - **Expected:** Message shown, add section works
2. Edit a lesson with no content
   - **Expected:** Message shown, add section works
3. Edit an exercise with no questions
   - **Expected:** Warning shown, can add questions

#### Special Characters
1. Create lesson with special characters in name: "Test & <Special> 'Lesson'"
2. Add it to a course
3. Search for it using special characters
4. **Expected:** Works correctly, no XSS

#### Maximum Values
1. Add 100+ lessons to a course
2. Add 50+ content items to a lesson
3. **Expected:** Still works, maybe with scrolling

#### Network Errors
1. Disable network in browser dev tools
2. Try to add a lesson to course
3. **Expected:** Error message shown
4. Re-enable network
5. Try again
6. **Expected:** Works correctly

### Pass Criteria
- ✅ Empty states handled gracefully
- ✅ Special characters don't break functionality
- ✅ No XSS vulnerabilities
- ✅ Large numbers handled
- ✅ Network errors handled with user-friendly messages

---

## Regression Testing

### Objective
Verify that existing features still work.

### Quick Checklist
- [ ] Can create courses
- [ ] Can create lessons
- [ ] Can create sublessons
- [ ] Can create exercises
- [ ] Can add questions to exercises (all types)
- [ ] Frontend displays courses correctly
- [ ] Frontend displays lessons correctly
- [ ] Students can take exercises
- [ ] Progress tracking works
- [ ] Enrollment works
- [ ] Existing drag-and-drop features work

---

## Reporting Issues

### Information to Include
1. **Version:** IELTS Course Manager v2.11
2. **WordPress Version:** (e.g., 6.4.2)
3. **PHP Version:** (e.g., 8.1)
4. **Browser:** (e.g., Chrome 120)
5. **Test Case:** (from this guide)
6. **Steps to Reproduce:**
7. **Expected Result:**
8. **Actual Result:**
9. **Screenshots:** (if applicable)
10. **Browser Console Errors:** (if any)

### Priority Levels
- **Critical:** Feature completely broken, security issue
- **High:** Feature partially broken, workaround exists
- **Medium:** Minor issue, doesn't block usage
- **Low:** Cosmetic issue, enhancement suggestion

---

## Sign-Off

### Tester Information
- **Name:**
- **Date:**
- **Version Tested:** 2.11

### Test Results Summary
- **Tests Passed:** ___ / 10
- **Tests Failed:** ___ / 10
- **Critical Issues:** ___
- **Recommendation:** ☐ Approve ☐ Approve with minor fixes ☐ More testing needed

### Notes


---

## Quick Reference: Where to Find Features

| Feature | Location |
|---------|----------|
| Collapsible Questions | IELTS Courses > Exercises > Edit Exercise |
| Course-Based Filtering | IELTS Courses > Exercises > Edit Exercise > Quiz Settings |
| Add/Remove Lessons | IELTS Courses > Courses > Edit Course > Course Lessons |
| Add/Remove Content | IELTS Courses > Lessons > Edit Lesson > Lesson Content |
| Drag-and-Drop Questions | IELTS Courses > Exercises > Edit Exercise > Questions |
| Drag-and-Drop Content | IELTS Courses > Lessons > Edit Lesson > Lesson Content |

---

## Troubleshooting Common Issues

### Questions Not Collapsing
- Check browser console for JavaScript errors
- Ensure jQuery and jQuery UI are loaded
- Try clearing browser cache

### AJAX Calls Failing
- Check that user has edit_posts capability
- Verify nonces are being created correctly
- Check server error logs for PHP errors
- Ensure ajaxurl is defined

### Search Not Working
- Ensure JavaScript is enabled
- Check that options are being loaded
- Try different search terms

### Drag-and-Drop Not Working
- Ensure jQuery UI Sortable is loaded
- Check that sortable is initialized
- Verify drag handle is clickable

---

*End of Testing Guide*
