# Version 2.25 Testing Guide

## Overview
Version 2.25 includes two major improvements:
1. Fix for lesson save issue when adding lessons from course page
2. Exercise import/export functionality

## Testing Checklist

### 1. Lesson Save Fix

#### Test Case 1.1: Add Lesson from Course Page
**Steps:**
1. Navigate to IELTS Courses > Courses
2. Edit an existing course
3. Scroll to "Course Lessons" meta box
4. Use the search/selector to find a lesson
5. Click "Add Selected Lesson"
6. Verify lesson appears in the course lessons list
7. Navigate to IELTS Courses > Lessons
8. Edit the lesson you just added
9. Verify the course appears in the "Assign to Courses" dropdown (should be selected)

**Expected Result:**
- Lesson should be added to course immediately
- Lesson should show the course assignment without needing to manually open and save

#### Test Case 1.2: Remove Lesson from Course
**Steps:**
1. Edit a course with at least one lesson
2. Click "Remove" button next to a lesson in Course Lessons meta box
3. Confirm removal
4. Navigate to the removed lesson
5. Verify the course is no longer selected in "Assign to Courses"

**Expected Result:**
- Lesson should be removed from course
- Course should no longer appear in lesson's course assignments

### 2. Exercise Import/Export

#### Test Case 2.1: Export Exercise
**Steps:**
1. Create or edit an exercise with:
   - Multiple questions (different types)
   - Reading texts (if using CBT layout)
   - Timer settings
   - Scoring type
2. Scroll to right sidebar
3. Find "Export Exercise" meta box
4. Click "Export Exercise" button
5. Verify JSON file downloads with format: `exercise-[title]-[date].json`
6. Open JSON file in text editor
7. Verify it contains:
   - Version field
   - Settings (timer, scoring type, layout)
   - Reading texts (if applicable)
   - All questions with their data

**Expected Result:**
- JSON file downloads successfully
- File contains all exercise data
- JSON is valid (can be verified at jsonlint.com)

#### Test Case 2.2: Import Exercise to Empty Exercise
**Steps:**
1. Create a new exercise with just a title (no questions)
2. Save as draft
3. Navigate to IELTS Courses > Import Exercise
4. Select the newly created exercise from dropdown
5. Upload the JSON file from Test Case 2.1
6. Click "Import Exercise"
7. Verify success message appears
8. Click "Edit Imported Exercise"
9. Verify all data was imported:
   - Questions match original
   - Settings match original
   - Reading texts match original

**Expected Result:**
- Import succeeds without errors
- All questions, settings, and reading texts are imported correctly

#### Test Case 2.3: Modify and Re-import
**Steps:**
1. Export an exercise
2. Open JSON in text editor
3. Modify some content:
   - Change question text
   - Change answer options
   - Change timer value
4. Save modified JSON
5. Import into a different exercise
6. Verify modified content appears in target exercise

**Expected Result:**
- Modified data imports correctly
- Changes are reflected in target exercise

#### Test Case 2.4: Import Security - File Size Limit
**Steps:**
1. Create a JSON file larger than 10MB (can use a text generator)
2. Try to import it
3. Verify error message about file size

**Expected Result:**
- Import fails with file too large error

#### Test Case 2.5: Import Security - Invalid JSON
**Steps:**
1. Create a .json file with invalid JSON content
2. Try to import it
3. Verify error message about invalid JSON

**Expected Result:**
- Import fails with invalid JSON error

#### Test Case 2.6: Import Security - Wrong File Type
**Steps:**
1. Try to upload a .txt or .xml file
2. Verify error message about file type

**Expected Result:**
- Import fails with invalid file type error

### 3. Version Update Verification

**Steps:**
1. Check plugin version in WordPress Plugins page
2. Verify version shows as 2.25
3. Check IELTS_CM_VERSION constant in code
4. Verify it's set to 2.25

**Expected Result:**
- Version displays as 2.25 everywhere

## Performance Testing

### Large Course with Many Lessons
**Steps:**
1. Create a course with 50+ lessons
2. Try adding/removing lessons
3. Verify operations complete in reasonable time (<5 seconds)

**Expected Result:**
- No timeout errors
- Responsive UI

### Large Exercise Export
**Steps:**
1. Create exercise with 40+ questions and multiple reading texts
2. Export to JSON
3. Verify export completes successfully

**Expected Result:**
- Export succeeds
- File size is reasonable (<1MB for typical exercise)

## Compatibility Testing

### Browser Testing
Test in the following browsers:
- Chrome (latest)
- Firefox (latest)
- Safari (latest)
- Edge (latest)

**Expected Result:**
- All features work consistently across browsers

### WordPress Version
Verify plugin works with:
- WordPress 5.8+
- Latest WordPress version

## Regression Testing

Verify existing features still work:
1. Creating courses, lessons, resources
2. Enrolling students
3. Taking quizzes
4. Progress tracking
5. Multi-site sync (if applicable)

## Security Summary

Version 2.25 includes the following security improvements:
1. **Import requires admin capability**: Only users with `manage_options` can import
2. **File size limit**: Maximum 10MB upload
3. **File type validation**: Only .json files accepted
4. **JSON structure validation**: Verifies proper format before import
5. **Whitelisted settings**: Only allowed setting keys can be imported
6. **Type-specific validation**: Each setting type validated appropriately
7. **Comprehensive sanitization**: All imported data sanitized before saving
8. **JSON encoding validation**: Export validates encoding succeeded

No vulnerabilities were introduced in this version.
