# Version 2.5 Testing Guide

## Overview

Version 2.5 introduces automatic question-to-passage linking for Computer-Based Test (CBT) layouts. This feature allows reading passages to automatically switch as students scroll through questions or navigate using question buttons.

## What's New

### Question-to-Passage Linking
- Each question can be linked to a specific reading text/passage
- When a student scrolls to a linked question, the corresponding passage automatically displays on the left
- Smooth fade transitions between passages
- Works with both scroll navigation and question button clicks

## Testing Instructions

### Prerequisites
- WordPress installation with IELTS Course Manager plugin activated
- Admin access to create/edit exercises

### Test Case 1: Basic Question-to-Passage Linking

#### Setup:
1. Navigate to "IELTS Courses > Exercises" in WordPress admin
2. Create a new exercise or edit an existing one
3. Set "Layout Type" to "Computer-Based IELTS Layout (Two Columns)"

#### Add Reading Passages:
1. Click "Add Reading Text" (appears after selecting CBT layout)
2. Add first passage:
   - Title: "Passage 1: Ancient Civilizations"
   - Content: Add sample text about ancient civilizations (300-500 words)
3. Click "Add Reading Text" again
4. Add second passage:
   - Title: "Passage 2: Modern Technology"
   - Content: Add sample text about modern technology (300-500 words)

#### Add Questions:
1. Click "Add Question" to add questions
2. For Questions 1-12:
   - Set question type (Multiple Choice, True/False, etc.)
   - Add question text
   - **Important**: Select "Passage 1: Ancient Civilizations" from the "Linked Reading Text" dropdown
3. For Questions 13-23:
   - Add questions as above
   - **Important**: Select "Passage 2: Modern Technology" from the "Linked Reading Text" dropdown

#### Save and Test:
1. Click "Publish" or "Update" to save the exercise
2. View the exercise on the frontend (as a logged-in student)
3. **Expected Behavior**:
   - Initially, Passage 1 should be visible on the left
   - Questions 1-23 visible on the right
   - As you scroll from Question 12 to Question 13, Passage 2 should automatically fade in
   - Clicking navigation button "13" at the bottom should also switch to Passage 2
   - Scrolling back to Question 12 or earlier should switch back to Passage 1

### Test Case 2: Multiple Passages with Different Question Groups

#### Setup:
Create an exercise with 3 reading passages:
- Passage 1: Questions 1-10
- Passage 2: Questions 11-20
- Passage 3: Questions 21-30

#### Test:
1. Scroll through questions slowly
2. Verify passages switch at the correct points (around questions 11 and 21)
3. Click navigation buttons for questions in different groups
4. Verify immediate passage switching with smooth transitions

### Test Case 3: Mixed Linking (Some Questions Unlinked)

#### Setup:
Create an exercise with:
- Passage 1: Linked to Questions 1-5
- Passage 2: Linked to Questions 10-15
- Questions 6-9: Not linked to any passage

#### Test:
1. Verify Questions 1-5 show Passage 1
2. Verify Questions 6-9 don't trigger passage switching (last viewed passage remains)
3. Verify Questions 10-15 show Passage 2

### Test Case 4: Dynamic Admin Interface

#### Test Admin Updates:
1. Create exercise with 1 reading text and 5 questions
2. Link all questions to the reading text
3. Click "Add Reading Text" to add a second passage
4. **Verify**: Question editors update to show both passages in the dropdown
5. Change title of first reading text
6. **Verify**: Dropdown updates immediately to reflect new title
7. Click "Add Question"
8. **Verify**: New question has reading text dropdown with all available passages
9. Remove a reading text
10. **Verify**: Dropdowns update to remove the deleted passage option

### Test Case 5: Backward Compatibility

#### Test:
1. Edit an existing exercise created in version 2.4 or earlier
2. **Verify**: Exercise still works correctly
3. Add CBT layout if not already set
4. Add reading texts
5. **Verify**: Questions don't have reading_text_id set (empty/null)
6. **Verify**: Exercise still displays correctly with default behavior (first passage visible)
7. Link some questions to passages
8. Save and test
9. **Verify**: Linked questions trigger passage switching, unlinked questions don't

## Expected Results

### Frontend Behavior:
- ✅ First reading passage visible by default
- ✅ Other passages initially hidden
- ✅ Smooth fade transition (300ms) when switching passages
- ✅ Passage switches when scrolling through questions
- ✅ Passage switches when clicking navigation buttons
- ✅ Reading column scrolls to top when switching passages
- ✅ Scroll detection has ~150ms debounce for performance
- ✅ Questions highlight briefly when navigated to via buttons

### Admin Interface:
- ✅ "Linked Reading Text" dropdown appears for each question
- ✅ Dropdown only shows when reading texts exist
- ✅ Dropdown updates dynamically when texts are added/removed
- ✅ Dropdown shows reading text titles or defaults to "Reading Text N"
- ✅ Option to select "No specific reading text" available
- ✅ Selection persists when saving exercise

## Known Behaviors

### By Design:
1. **Questions without links**: Don't trigger passage switching; last viewed passage remains visible
2. **First passage default**: Always shown initially, even if first question is linked to a different passage
3. **Debounced scrolling**: 150ms delay before detecting scroll position to improve performance
4. **Admin field visibility**: Reading text selector only appears when at least one reading text exists

### Platform Requirements:
- Requires JavaScript to be enabled for automatic switching
- Works in all modern browsers (Chrome, Firefox, Safari, Edge)
- Mobile responsive but desktop experience recommended for best results

## Troubleshooting

### Issue: Passages not switching
**Check:**
- Questions have reading_text_id assigned
- Layout type is set to "Computer-Based IELTS Layout"
- JavaScript is enabled in browser
- No JavaScript errors in browser console (F12)

### Issue: Dropdown not appearing in admin
**Check:**
- At least one reading text exists
- Exercise is using CBT layout type
- Browser cache cleared after plugin update

### Issue: Smooth transitions not working
**Check:**
- Browser supports CSS transitions
- No conflicting CSS from theme
- frontend.css properly loaded

## Rollback Procedure

If issues occur:
1. Questions without `reading_text_id` work as before (no impact)
2. Can leave `reading_text_id` empty/null to disable feature
3. Can switch back to "Standard Layout" to bypass CBT layout entirely
4. Previous version data structure fully compatible

## Version Information

- **Plugin Version**: 2.5
- **Release Date**: 2025-12-18
- **Backward Compatible**: Yes (with versions 2.4 and earlier)
- **Database Changes**: None (uses existing meta structure)

## Support

For issues or questions:
1. Check this testing guide
2. Review COMPUTER_BASED_LAYOUT_GUIDE.md
3. Check CHANGELOG.md for version details
4. Review browser console for JavaScript errors
5. Contact plugin support with specific test case details
