# Version 2.44 Testing Guide

## Overview
This guide provides comprehensive testing scenarios for version 2.44, which adds text format support for all question types in the Text Exercises Creator.

## Prerequisites
- WordPress admin access with `manage_options` capability
- IELTS Course Manager plugin version 2.44 installed
- Access to "IELTS Courses > Create Exercises from Text" menu

## Testing Approach
For each question type, we'll:
1. Create an exercise using the text format
2. Verify the exercise is created successfully
3. Check the exercise in the admin editor
4. View the exercise on the frontend
5. Submit answers and verify grading

## Test Cases

### Test 1: Multiple Choice Questions

#### Input Text
```
Reading Comprehension [MULTIPLE CHOICE]

Questions 1-3: Choose the correct answer.

1. What is the capital of France?
A) London
B) Paris [CORRECT]
C) Berlin [FEEDBACK: Berlin is the capital of Germany]
D) Madrid

2. Which planet is known as the Red Planet?
A) Venus
B) Mars [CORRECT]
C) Jupiter [FEEDBACK: Jupiter is the largest planet]
D) Saturn

3. What is the largest ocean on Earth?
A) Atlantic Ocean
B) Indian Ocean
C) Arctic Ocean
D) Pacific Ocean [CORRECT]
```

#### Expected Results
- ✅ Exercise created with title "Reading Comprehension [MULTIPLE CHOICE]"
- ✅ 3 questions created, all type 'multiple_choice'
- ✅ Each question has 4 options (A, B, C, D)
- ✅ Correct answers: Q1=B, Q2=B, Q3=D
- ✅ Feedback appears for Berlin and Jupiter options when selected
- ✅ Questions display as radio buttons on frontend
- ✅ Grading works correctly

#### Test Steps
1. Navigate to "Create Exercises from Text"
2. Paste the input text
3. Select "Draft" status
4. Click "Create Exercise"
5. Verify success message
6. Open the created exercise in the editor
7. Check question types, options, and correct answers
8. Preview or publish the exercise
9. View as student
10. Answer questions and submit
11. Verify grading and feedback display

---

### Test 2: Multi Select Questions

#### Input Text
```
Science Quiz [MULTI SELECT]

Select all correct answers.

1. Which of the following are primary colors?
A) Red [CORRECT]
B) Green
C) Blue [CORRECT]
D) Yellow [CORRECT]

2. Which planets are gas giants?
A) Mars
B) Jupiter [CORRECT]
C) Saturn [CORRECT]
D) Venus
```

#### Expected Results
- ✅ Exercise created with title "Science Quiz [MULTI SELECT]"
- ✅ 2 questions created, all type 'multi_select'
- ✅ Correct answers: Q1=A,C,D (0,2,3), Q2=B,C (1,2)
- ✅ Questions display as checkboxes on frontend
- ✅ Multiple selections allowed
- ✅ Grading requires all correct answers selected

---

### Test 3: Headings Questions

#### Input Text
```
Match the headings [HEADINGS]

Choose the most suitable heading for each paragraph.

1. Paragraph A discusses different types of renewable energy sources.
A) The cost of solar panels
B) Types of renewable energy [CORRECT]
C) Climate change effects
D) Fossil fuel reserves

2. Paragraph B explains how wind turbines generate electricity.
A) Wind turbine mechanics [CORRECT]
B) Solar energy benefits
C) Hydroelectric dams
D) Nuclear power plants
```

#### Expected Results
- ✅ Exercise type 'headings'
- ✅ 2 questions created
- ✅ Correct answers: Q1=B, Q2=A
- ✅ Displays as radio button selection

---

### Test 4: Matching/Classifying Questions

#### Input Text
```
Classify each animal [MATCHING]

Choose the correct classification for each animal.

1. Lion
A) Mammal [CORRECT]
B) Reptile
C) Bird
D) Fish

2. Eagle
A) Mammal
B) Reptile
C) Bird [CORRECT]
D) Fish

3. Crocodile
A) Mammal
B) Reptile [CORRECT]
C) Bird
D) Fish
```

#### Expected Results
- ✅ Exercise type 'matching_classifying'
- ✅ 3 questions created
- ✅ Correct answers: Q1=A, Q2=C, Q3=B

---

### Test 5: Locating Information Questions

#### Input Text
```
Which paragraph contains the following information? [LOCATING INFORMATION]

1. Information about the history of the Internet
A) Paragraph A [CORRECT]
B) Paragraph B
C) Paragraph C
D) Paragraph D

2. Details about social media platforms
A) Paragraph A
B) Paragraph B
C) Paragraph C [CORRECT]
D) Paragraph D
```

#### Expected Results
- ✅ Exercise type 'locating_information'
- ✅ 2 questions created
- ✅ Correct answers: Q1=A, Q2=C

---

### Test 6: Summary Completion Questions

#### Input Text
```
Summary Completion

Complete the summary using the words provided.

The Industrial Revolution began in [ANSWER 1] during the late 18th century. The [ANSWER 2] industry was one of the first to benefit from mechanization. Inventions such as the [ANSWER 3] revolutionized production.

{1:Britain|UK|United Kingdom|2:textile|textiles|3:spinning jenny|power loom}
```

#### Expected Results
- ✅ Exercise type 'summary_completion'
- ✅ 1 question created
- ✅ Question text contains [ANSWER 1], [ANSWER 2], [ANSWER 3] placeholders
- ✅ Correct answers stored: "1:Britain|UK|United Kingdom|2:textile|textiles|3:spinning jenny|power loom"
- ✅ Frontend displays inline text input fields
- ✅ Accepts any alternative answer (case-insensitive)

#### Test Steps
1. Create exercise with input text
2. View on frontend
3. Verify 3 inline input fields appear in the text
4. Enter answers: "UK", "textile", "spinning jenny"
5. Submit and verify all marked correct
6. Try alternatives: "United Kingdom", "textiles", "power loom"
7. Verify still marked correct

---

### Test 7: Dropdown Paragraph Questions

#### Input Text
```
Formal Letter Writing

Complete the formal letter by selecting the correct options.

I am writing to ___1___ that the meeting scheduled for tomorrow has been ___2___ until ___3___.

DROPDOWN 1:
A) inform you [CORRECT]
B) let you know
C) tell you

DROPDOWN 2:
A) postponed [CORRECT]
B) delayed
C) cancelled

DROPDOWN 3:
A) next week [CORRECT]
B) next month
C) further notice
```

#### Expected Results
- ✅ Exercise type 'dropdown_paragraph'
- ✅ 1 question created
- ✅ Question text converted to: "I am writing to 1.[A: inform you B: let you know C: tell you] that..."
- ✅ Correct answer: "1:A|2:A|3:A"
- ✅ dropdown_options field populated with structured data
- ✅ Frontend displays inline dropdown selects
- ✅ Each dropdown shows 3 options
- ✅ Grading checks all dropdown selections

#### Test Steps
1. Create exercise with input text
2. View on frontend
3. Verify 3 dropdown selects appear inline with text
4. Select correct options: A, A, A
5. Submit and verify correct
6. Try incorrect: B, B, B
7. Verify marked incorrect

---

### Test 8: Essay Questions

#### Input Text
```
IELTS Writing Task 2

[ESSAY]
Some people believe that technology has made our lives easier, while others think it has made life more complicated. 

Discuss both views and give your opinion.

Write at least 250 words.

{POINTS:10}
```

#### Expected Results
- ✅ Exercise type 'essay'
- ✅ 1 question created
- ✅ Question text contains the prompt
- ✅ Points set to 10
- ✅ No correct_answer (manual grading)
- ✅ Frontend displays large textarea
- ✅ No automatic grading (requires instructor review)

---

### Test 9: Short Answer Questions (Existing Format)

#### Input Text
```
Reading Comprehension Questions

Answer the following questions using NO MORE THAN THREE WORDS from the passage.

1. Where did the Industrial Revolution begin? {[BRITAIN][THE UK][UNITED KINGDOM]}
[CORRECT] Excellent! You found the correct location.
[INCORRECT] Check the first sentence of the passage.

2. Which industry was mentioned first? {[TEXTILE][TEXTILES]}

3. Name one invention mentioned. {[SPINNING JENNY][POWER LOOM]}
```

#### Expected Results
- ✅ Exercise type 'short_answer'
- ✅ 3 questions created
- ✅ Multiple alternative answers supported
- ✅ Feedback displayed (correct, incorrect, no answer)
- ✅ Case-insensitive matching
- ✅ Punctuation-agnostic matching

---

### Test 10: True/False Questions (Existing Format)

#### Input Text
```
Reading Test Questions - True or False

You have to answer 40 questions
This is TRUE
Correct answer
This is FALSE
Incorrect

There are 40 questions in the reading test.

You have one hour to complete the test
This is TRUE
Correct answer
This is FALSE
Incorrect

You have one hour for the complete test.
```

#### Expected Results
- ✅ Exercise type 'true_false'
- ✅ 2 questions created
- ✅ Each has TRUE/FALSE options
- ✅ Correct answers marked
- ✅ Feedback included

---

### Test 11: With Reading Passage

#### Input Text
```
[READING PASSAGE] The Industrial Revolution
The Industrial Revolution began in Britain during the late 18th century and transformed society from an agricultural economy to one dominated by industry and machine manufacturing.

The textile industry was one of the first to benefit from mechanization. Inventions such as the spinning jenny and power loom revolutionized cloth production.
[END READING PASSAGE]

Reading Comprehension

1. Where did the Industrial Revolution begin? {BRITAIN}
2. Which industry benefited first? {TEXTILE}
3. Name one invention. {[SPINNING JENNY][POWER LOOM]}
```

#### Expected Results
- ✅ Reading passage extracted and stored separately
- ✅ Layout type set to 'computer_based'
- ✅ 3 questions created as short_answer type
- ✅ Frontend displays reading text on left, questions on right
- ✅ Text highlighting enabled

---

## Edge Cases & Error Handling

### Test 12: Empty Text Input
- Input: Empty textarea
- Expected: Error message "Please enter exercise text before submitting."

### Test 13: No Questions Found
- Input: Title only, no questions
- Expected: Error message "No questions found in the text"

### Test 14: Malformed Input
- Input: Questions without options, options without questions
- Expected: Graceful handling, create what's parsable

### Test 15: HTML Tags in Input
- Input: Text with `<script>alert('XSS')</script>`
- Expected: HTML tags stripped, only text remains

### Test 16: Special Characters
- Input: Questions with quotes, apostrophes, accents
- Expected: Characters preserved correctly

### Test 17: Very Long Input
- Input: 100+ questions
- Expected: All questions parsed, no timeout

### Test 18: Mixed Formats
- Input: Multiple question types in same text
- Expected: Detects first matching format, parses accordingly

---

## Backward Compatibility Tests

### Test 19: Existing Short Answer Exercises
- Action: Create exercises using existing Short Answer format
- Expected: Works exactly as before, no regressions

### Test 20: Existing True/False Exercises
- Action: Create exercises using existing True/False format
- Expected: Works exactly as before, no regressions

### Test 21: Previously Created Exercises
- Action: View and take previously created exercises
- Expected: All render and function correctly

---

## Security Tests

### Test 22: Non-Admin User Access
- Action: Access "Create Exercises from Text" as non-admin
- Expected: Access denied

### Test 23: Without Nonce
- Action: Submit form without nonce
- Expected: Security check fails

### Test 24: SQL Injection Attempt
- Input: `'; DROP TABLE wp_postmeta; --` in question text
- Expected: Sanitized, no SQL executed

### Test 25: XSS Attempt
- Input: `<img src=x onerror=alert('XSS')>` in question text
- Expected: Tags stripped, only text stored

---

## Performance Tests

### Test 26: Large Text Input
- Input: 10,000 characters of text
- Expected: Parses in < 5 seconds

### Test 27: Many Questions
- Input: 100 questions in one exercise
- Expected: All parsed correctly, no memory issues

### Test 28: Complex Regex Patterns
- Input: Text designed to stress regex patterns
- Expected: No timeout, no ReDoS

---

## Checklist

### Functionality
- [ ] All 14 question types can be created via text format
- [ ] Multiple choice format detection works
- [ ] Multi select type marker recognized
- [ ] Headings type marker recognized
- [ ] Matching type marker recognized
- [ ] Locating information type marker recognized
- [ ] Summary completion placeholders detected
- [ ] Dropdown paragraph placeholders detected
- [ ] Essay marker detected
- [ ] Short answer format still works
- [ ] True/false format still works

### Options & Answers
- [ ] [CORRECT] marker identifies correct answers
- [ ] [FEEDBACK: ...] marker adds option feedback
- [ ] Multiple correct answers work for multi-select
- [ ] Alternative answers work for short answer
- [ ] Dropdown options parsed correctly
- [ ] Summary answers with alternatives work

### Reading Passages
- [ ] [READING PASSAGE] marker recognized
- [ ] [READING TEXT] marker recognized
- [ ] Reading passage extracted correctly
- [ ] Layout set to computer_based when passage present
- [ ] Reading text displays on frontend

### Frontend Display
- [ ] Multiple choice shows radio buttons
- [ ] Multi select shows checkboxes
- [ ] Summary completion shows inline inputs
- [ ] Dropdown paragraph shows inline selects
- [ ] Essay shows large textarea
- [ ] Short answer shows text input
- [ ] True/false shows radio buttons

### Grading
- [ ] Multiple choice grading works
- [ ] Multi select requires all correct
- [ ] Summary completion accepts alternatives
- [ ] Dropdown paragraph checks all selections
- [ ] Short answer accepts alternatives
- [ ] True/false grading works
- [ ] Essay has no automatic grading

### Security
- [ ] HTML tags stripped from input
- [ ] No XSS vulnerabilities
- [ ] No SQL injection vulnerabilities
- [ ] Admin-only access enforced
- [ ] Nonce verification works

### Backward Compatibility
- [ ] Existing short answer format works
- [ ] Existing true/false format works
- [ ] Previously created exercises still work
- [ ] No database migration needed

### Documentation
- [ ] All format examples displayed
- [ ] Examples are accurate
- [ ] Instructions are clear
- [ ] Success notice displays

---

## Known Issues
None identified at this time.

## Regression Testing
After completing all tests above:
1. Test previously created exercises (v2.43 and earlier)
2. Test Exercise Editor (ensure no conflicts)
3. Test JSON Import (ensure no conflicts)
4. Test quiz taking functionality
5. Test progress tracking
6. Test student dashboard

---

## Sign-Off

| Role | Name | Status | Date |
|------|------|--------|------|
| Developer | | ✅ Complete | 2025-12-20 |
| QA Tester | | ⏳ Pending | |
| Product Owner | | ⏳ Pending | |

---

## Notes
- All new parsers follow the same sanitization and security patterns as existing parsers
- Format detection is order-dependent: most specific formats checked first
- Regex patterns optimized for performance and security
- All functionality is backward compatible
