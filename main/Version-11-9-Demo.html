<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transcript Highlighting Demo - Version 11.9</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .demo-container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        h1 {
            color: #333;
            border-bottom: 3px solid #0073aa;
            padding-bottom: 10px;
        }
        
        h2 {
            color: #0073aa;
            margin-top: 30px;
        }
        
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .example {
            border: 2px solid #ddd;
            padding: 20px;
            border-radius: 5px;
            background: #fafafa;
        }
        
        .example h3 {
            margin-top: 0;
            color: #333;
        }
        
        .bad-example {
            border-color: #dc3232;
        }
        
        .bad-example h3 {
            color: #dc3232;
        }
        
        .good-example {
            border-color: #46b450;
        }
        
        .good-example h3 {
            color: #46b450;
        }
        
        .transcript-content {
            background: white;
            padding: 15px;
            border-radius: 4px;
            line-height: 1.8;
        }
        
        .question-marker-badge {
            display: inline-block;
            background: #ffc107;
            color: #333;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.85em;
            font-weight: bold;
            margin: 0 4px;
            vertical-align: baseline;
        }
        
        .transcript-answer-marker {
            background-color: #fff9c4;
            padding: 2px 8px;
            border-radius: 3px;
            margin: 0 2px;
        }
        
        .transcript-highlight {
            background-color: #fff9c4 !important;
            padding: 12px 16px !important;
            border-left: 4px solid #ffc107 !important;
            margin: 10px 0 !important;
            border-radius: 4px;
        }
        
        table {
            border-collapse: collapse;
            width: 100%;
        }
        
        table td {
            border: 1px solid #ddd;
            padding: 10px;
            vertical-align: top;
        }
        
        strong {
            font-weight: bold;
        }
        
        .note {
            background: #e7f3ff;
            border-left: 4px solid #0073aa;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        .note strong {
            color: #0073aa;
        }
        
        code {
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <h1>IELTS Transcript Highlighting - Version 11.9 Fix</h1>
        
        <div class="note">
            <strong>Issue Summary:</strong> The Q markers were placed at the beginning of sentences rather than immediately before the actual answer text. This caused confusion about which part of the transcript contained the answer.
        </div>
        
        <h2>The Problem (Before Fix)</h2>
        
        <div class="example bad-example">
            <h3>❌ INCORRECT: Q marker at start of sentence</h3>
            <div class="transcript-content">
                <table>
                    <tr>
                        <td width="20%"><strong>Admissions officer:</strong></td>
                        <td width="80%">That's great. Okay so first of all, can you tell me your name please?</td>
                    </tr>
                    <tr>
                        <td width="20%"><strong>Anne:</strong></td>
                        <td width="80%">
                            <span id="transcript-q1" data-question="1">
                                <span class="question-marker-badge">Q1</span>
                            </span>
                            <span class="transcript-answer-marker">Yes of course.</span> It's Anne Hawberry.
                        </td>
                    </tr>
                </table>
            </div>
            <p><strong>Problem:</strong> The Q1 badge appears at the very beginning, and "Yes of course." gets highlighted instead of the actual answer "Anne Hawberry".</p>
        </div>
        
        <h2>The Solution (After Fix)</h2>
        
        <div class="example good-example">
            <h3>✅ CORRECT: Q marker immediately before the answer</h3>
            <div class="transcript-content">
                <table>
                    <tr>
                        <td width="20%"><strong>Admissions officer:</strong></td>
                        <td width="80%">That's great. Okay so first of all, can you tell me your name please?</td>
                    </tr>
                    <tr>
                        <td width="20%"><strong>Anne:</strong></td>
                        <td width="80%">
                            Yes of course. It's 
                            <span id="transcript-q1" data-question="1">
                                <span class="question-marker-badge">Q1</span>
                            </span>
                            <span class="transcript-answer-marker">Anne Hawberry.</span>
                        </td>
                    </tr>
                </table>
            </div>
            <p><strong>Solution:</strong> The Q1 badge appears right before "Anne Hawberry", and only the answer text gets the yellow background highlight.</p>
        </div>
        
        <h2>How It Works Now</h2>
        
        <div class="note">
            <strong>Technical Implementation:</strong>
            <ul>
                <li>The <code>[Q1]</code> marker must be placed in the transcript immediately before the answer text</li>
                <li>Pattern: <code>/\[Q(\d+)\]([^\[]*?)(?=\[Q|$)/is</code> captures text after the marker</li>
                <li>First sentence or ~100 characters after the marker gets wrapped in yellow highlight</li>
                <li>The Q badge remains visible with yellow background (#ffc107)</li>
                <li>Answer text gets light yellow background (#fff9c4)</li>
            </ul>
        </div>
        
        <h2>Another Example - Numeric Answer</h2>
        
        <div class="comparison">
            <div class="example bad-example">
                <h3>❌ Before</h3>
                <div class="transcript-content">
                    <table>
                        <tr>
                            <td width="20%"><strong>Anne:</strong></td>
                            <td width="80%">
                                <span class="question-marker-badge">Q2</span>
                                <span class="transcript-answer-marker">I'm 24.</span> My date of birth is 22 May 1981.
                            </td>
                        </tr>
                    </table>
                </div>
                <p>Highlights "I'm 24." instead of the full date</p>
            </div>
            
            <div class="example good-example">
                <h3>✅ After</h3>
                <div class="transcript-content">
                    <table>
                        <tr>
                            <td width="20%"><strong>Anne:</strong></td>
                            <td width="80%">
                                I'm 24. My date of birth is 
                                <span class="question-marker-badge">Q2</span>
                                <span class="transcript-answer-marker">22 May 1981.</span>
                            </td>
                        </tr>
                    </table>
                </div>
                <p>Correctly highlights "22 May 1981." - the actual answer</p>
            </div>
        </div>
        
        <h2>Guidelines for Transcript Authors</h2>
        
        <div class="note">
            <strong>When creating or editing transcripts:</strong>
            <ol>
                <li>Place <code>[Q#]</code> markers <strong>immediately before the actual answer text</strong>, not at the beginning of sentences</li>
                <li>The marker should be as close to the answer as possible</li>
                <li>For short answers (single words/numbers), place right before the answer</li>
                <li>For longer answers (phrases/sentences), place at the start of the answer phrase</li>
                <li>The highlighting will automatically wrap the first sentence or ~100 characters after the marker</li>
            </ol>
        </div>
        
        <h2>Visual Summary</h2>
        
        <div style="background: #f9f9f9; padding: 20px; border-radius: 5px; margin-top: 20px;">
            <p><strong>Key Visual Elements:</strong></p>
            <ul>
                <li><span class="question-marker-badge">Q1</span> Yellow badge shows question number</li>
                <li><span class="transcript-answer-marker">Answer text here</span> Light yellow background highlights the answer</li>
                <li>Both elements should appear together, near the actual answer in the transcript</li>
            </ul>
        </div>
    </div>
</body>
</html>
