# Version 2.14 Testing Guide

## Overview
This guide provides detailed testing instructions for version 2.14 features.

## Pre-Testing Setup

### Requirements
- WordPress 5.8+
- PHP 7.2+
- Active IELTS Course Manager plugin v2.14
- At least one course created
- At least one lesson in the course
- Test user account with student role

### Test Data Preparation
1. Create a test course (or use existing)
2. Create a test lesson in the course (or use existing)
3. Create a test CBT quiz linked to the course and lesson
4. Add 2-3 reading passages to the quiz
5. Add 10-12 questions, linked to different passages:
   - Questions 1-5: Link to Passage 0
   - Questions 6-10: Link to Passage 1
   - Questions 11-12: Link to Passage 2 (optional)
6. Include at least 2-3 True/False/Not Given questions
7. Add feedback (correct_feedback and/or incorrect_feedback) to several questions

## Feature Testing

### Feature 1: Return to Course Button

#### Test 1.1: Button Appears in CBT Modal
**Steps:**
1. As a student, navigate to the test lesson page
2. Click on the CBT quiz link
3. Answer all questions
4. Click "Submit Quiz"
5. Wait for results modal to appear

**Expected Results:**
- ✅ "Return to course" button appears in top right of modal
- ✅ Button is positioned next to the close (×) button
- ✅ Button has blue background (#0073aa)
- ✅ Button text reads "Return to course"

**Screenshots to capture:**
- Modal with "Return to course" button visible

#### Test 1.2: Button Styling and Hover
**Steps:**
1. Continue from Test 1.1 (modal is open)
2. Hover mouse over "Return to course" button
3. Move mouse away

**Expected Results:**
- ✅ Button background changes to darker blue (#005a87) on hover
- ✅ Button returns to original color when mouse moves away
- ✅ Cursor changes to pointer on hover
- ✅ Button has rounded corners (border-radius: 4px)

#### Test 1.3: Button Functionality
**Steps:**
1. Continue from Test 1.1 (modal is open)
2. Click "Return to course" button

**Expected Results:**
- ✅ Browser navigates to course page
- ✅ Course page loads correctly
- ✅ URL matches the course permalink

#### Test 1.4: Button Absent When No Course
**Steps:**
1. Create a quiz NOT linked to any course
2. Take the quiz as a student
3. Submit and view results modal

**Expected Results:**
- ✅ "Return to course" button does NOT appear
- ✅ Only close (×) button is visible
- ✅ No JavaScript errors in console

#### Test 1.5: Button in Different Screen Sizes
**Steps:**
1. Open quiz results modal (Test 1.1)
2. Resize browser window to various widths:
   - 1920px (desktop)
   - 1024px (tablet landscape)
   - 768px (tablet portrait)
   - 375px (mobile)

**Expected Results:**
- ✅ Button remains visible at all screen sizes
- ✅ Button doesn't overlap with close button
- ✅ Button text is readable
- ✅ Layout remains intact

**Known Issues:**
- On very small screens (<400px), button may wrap to next line
- This is acceptable as CBT is designed for desktop use

---

### Feature 2: Reading Passage Labels

#### Test 2.1: Basic Passage Label Display
**Steps:**
1. Create/edit a CBT quiz with reading passages
2. Link questions to passages:
   - Q1-5 → Passage 0 (title: "Urban Development")
   - Q6-10 → Passage 1 (title: "Climate Change")
3. View quiz in CBT mode

**Expected Results:**
- ✅ Bottom navigation shows: "Urban Development" | 1 2 3 4 5 | "Climate Change" | 6 7 8 9 10
- ✅ Passage labels have blue text (#0073aa)
- ✅ Passage labels have light blue background (#f0f6fc)
- ✅ Labels are visually distinct from question buttons

**Screenshots to capture:**
- Bottom navigation with passage labels

#### Test 2.2: Default Passage Names
**Steps:**
1. Create a quiz with passages that have NO custom titles
2. Link questions to passages
3. View quiz in CBT mode

**Expected Results:**
- ✅ Labels show "Reading Passage 1", "Reading Passage 2", etc.
- ✅ Numbering starts at 1 (not 0)
- ✅ All passages are numbered sequentially

#### Test 2.3: Mixed Passage Links
**Steps:**
1. Create quiz with 3 passages
2. Link questions as follows:
   - Q1-3 → Passage 0
   - Q4-6 → Passage 1
   - Q7-9 → No passage (null)
   - Q10-12 → Passage 2

**Expected Results:**
- ✅ "Reading Passage 1" appears before questions 1-3
- ✅ "Reading Passage 2" appears before questions 4-6
- ✅ NO label appears before questions 7-9 (unlinked questions)
- ✅ "Reading Passage 3" appears before questions 10-12
- ✅ Navigation flows naturally without breaking

#### Test 2.4: Single Question Per Passage
**Steps:**
1. Create quiz where each passage has only 1 question:
   - Q1 → Passage 0
   - Q2 → Passage 1
   - Q3 → Passage 2

**Expected Results:**
- ✅ "Reading Passage 1" | 1 | "Reading Passage 2" | 2 | "Reading Passage 3" | 3
- ✅ Labels appear correctly even with single questions
- ✅ No visual glitches or spacing issues

#### Test 2.5: All Questions Unlinked
**Steps:**
1. Create quiz with passages defined
2. Leave all questions WITHOUT reading_text_id
3. View quiz in CBT mode

**Expected Results:**
- ✅ No passage labels appear
- ✅ Just question numbers: 1 2 3 4 5 6 7 8 9 10
- ✅ Layout looks normal (as in v2.13)

#### Test 2.6: Long Passage Titles
**Steps:**
1. Create passage with very long title: "The Impact of Global Warming on Arctic Wildlife Populations"
2. Link questions to this passage
3. View quiz in different screen sizes

**Expected Results:**
- ✅ Title displays fully on wide screens
- ✅ Title may wrap on narrow screens
- ✅ No overflow issues
- ✅ Remains readable

---

### Feature 3: True/False/Not Given Dropdown

#### Test 3.1: Dropdown on New Questions
**Steps:**
1. Edit a quiz in admin
2. Click "Add Question"
3. Select "True/False/Not Given" as question type
4. Observe the "Correct Answer" field

**Expected Results:**
- ✅ Field is a dropdown (not text input)
- ✅ Dropdown contains 4 options:
  - "-- Select correct answer --" (default, empty value)
  - "True"
  - "False"
  - "Not Given"
- ✅ Default option is selected initially

**Screenshots to capture:**
- Admin interface showing True/False dropdown

#### Test 3.2: Saving and Loading
**Steps:**
1. Create a True/False/Not Given question
2. Set correct answer to "True"
3. Save the quiz
4. Reload the page/edit quiz again
5. Expand the question

**Expected Results:**
- ✅ Dropdown shows "True" as selected
- ✅ Value is preserved correctly
- ✅ No data loss

#### Test 3.3: Changing Between Question Types
**Steps:**
1. Add a new question
2. Select "Fill in the Blank" type
3. Observe the "Correct Answer" field (should be text input)
4. Change type to "True/False/Not Given"
5. Observe the field again
6. Change back to "Fill in the Blank"

**Expected Results:**
- ✅ Field changes from text input to dropdown when switching to True/False
- ✅ Field changes from dropdown to text input when switching away
- ✅ No JavaScript errors
- ✅ Conversion is smooth and instant

#### Test 3.4: Value Preservation During Type Change
**Steps:**
1. Add a True/False/Not Given question
2. Select "False" in dropdown
3. Change question type to "Fill in the Blank"
4. Observe text input (should show "false")
5. Change back to "True/False/Not Given"
6. Observe dropdown

**Expected Results:**
- ✅ Text input shows "false" after conversion
- ✅ Dropdown shows "False" when converted back
- ✅ Value is preserved through conversions

#### Test 3.5: Existing True/False Questions
**Steps:**
1. Find an existing True/False question created in v2.13 or earlier
2. Edit the quiz in admin
3. Expand the question

**Expected Results:**
- ✅ Field is now a dropdown (converted from text input)
- ✅ Saved value is correctly selected in dropdown
- ✅ Question functions normally on frontend
- ✅ No data corruption

#### Test 3.6: Invalid Values
**Steps:**
1. In database, manually set a True/False question's correct_answer to "invalid_value"
2. Edit the quiz in admin
3. Expand the question

**Expected Results:**
- ✅ Dropdown shows "-- Select correct answer --" (empty selection)
- ✅ No JavaScript errors
- ✅ Admin can select a valid value and save

#### Test 3.7: Frontend Display
**Steps:**
1. Create a True/False question with "Not Given" as correct answer
2. Save and view quiz as student
3. Submit quiz with wrong answer
4. Review results

**Expected Results:**
- ✅ Question displays three radio buttons (True, False, Not Given)
- ✅ Correct answer is highlighted as "Not Given"
- ✅ Answer checking works correctly
- ✅ Feedback displays properly

---

### Feature 4: Multiple Choice Feedback (Verification)

#### Test 4.1: Multiple MC Questions with Feedback
**Steps:**
1. Create CBT quiz with 3 multiple choice questions
2. Add feedback to all three questions:
   - Q1: correct_feedback = "Good job on Q1!"
   - Q2: incorrect_feedback = "Review topic for Q2"
   - Q3: correct_feedback = "Excellent!" incorrect_feedback = "Try again for Q3"
3. Take quiz as student
4. Answer Q1 correctly, Q2 incorrectly, Q3 correctly
5. Submit quiz
6. Click "Review my answers"

**Expected Results:**
- ✅ Q1 shows "Good job on Q1!" (correct feedback)
- ✅ Q2 shows "Review topic for Q2" (incorrect feedback)
- ✅ Q3 shows "Excellent!" (correct feedback)
- ✅ All three questions display their feedback
- ✅ No question is missing feedback that should be displayed

**Note:** If only first question shows feedback, this is the reported bug. 
However, code review suggests implementation is correct. If bug occurs:
- Check browser console for errors
- Verify all questions have feedback configured in admin
- Check network tab to see if feedback is in AJAX response

#### Test 4.2: Option-Specific Feedback
**Steps:**
1. Create MC question with option-specific feedback:
   - Option A: "Think about X"
   - Option B: "Consider Y" 
   - Option C: "Correct!" (correct answer)
   - Option D: "Remember Z"
2. Take quiz, select Option B
3. Submit and review

**Expected Results:**
- ✅ Feedback shows "Consider Y" (option B's feedback)
- ✅ Correct answer (C) is highlighted
- ✅ Wrong answer (B) is highlighted as incorrect

---

## Integration Testing

### Integration Test 1: Complete CBT Workflow
**Steps:**
1. As student, start a CBT quiz with all v2.14 features
2. Navigate through questions using passage labels
3. Answer True/False question using radio buttons
4. Complete quiz and submit
5. Click "Return to course" from modal
6. Return to lesson and retake quiz
7. Review answers to see feedback

**Expected Results:**
- ✅ All features work together seamlessly
- ✅ No conflicts or breaking changes
- ✅ User experience is smooth

### Integration Test 2: Different Quiz Types
**Steps:**
1. Create one Standard Layout quiz
2. Create one CBT quiz
3. Test both as student

**Expected Results:**
- ✅ Standard quiz works as before (v2.13 behavior)
- ✅ CBT quiz has new features
- ✅ No interference between quiz types

---

## Regression Testing

### Regression Test 1: Existing Quiz Functionality
**Steps:**
1. Test all existing quiz features from v2.13:
   - Quiz submission
   - Score calculation
   - Progress tracking
   - Answer highlighting
   - Review answers button
   - Retake button

**Expected Results:**
- ✅ All existing features work as before
- ✅ No breaking changes

### Regression Test 2: Non-CBT Quizzes
**Steps:**
1. Take a standard (non-CBT) quiz
2. Submit and view results

**Expected Results:**
- ✅ Standard quizzes unaffected by CBT changes
- ✅ Feedback displays inline (not in modal)
- ✅ No "Return to course" button (not applicable)
- ✅ No passage labels (not applicable)

---

## Browser Compatibility Testing

### Browsers to Test
- Chrome (latest)
- Firefox (latest)
- Safari (latest, Mac only)
- Edge (latest)
- Mobile Safari (iOS)
- Chrome Mobile (Android)

### Test Matrix
For each browser, verify:
- [ ] Return to course button displays and functions
- [ ] Passage labels display correctly
- [ ] True/False dropdown works in admin
- [ ] No JavaScript console errors
- [ ] Styling renders correctly

---

## Performance Testing

### Performance Test 1: Quiz with Many Questions
**Steps:**
1. Create quiz with 50+ questions
2. Load quiz in CBT mode
3. Monitor page load time
4. Navigate through questions

**Expected Results:**
- ✅ Page loads in reasonable time (<3 seconds)
- ✅ Navigation is responsive
- ✅ No performance degradation from passage labels

### Performance Test 2: Long Passage Titles
**Steps:**
1. Create passages with very long titles (100+ characters)
2. Load quiz

**Expected Results:**
- ✅ Page loads normally
- ✅ No performance impact
- ✅ Titles display without breaking layout

---

## Accessibility Testing

### Accessibility Test 1: Keyboard Navigation
**Steps:**
1. Open CBT quiz
2. Use Tab key to navigate
3. Use Enter to click buttons

**Expected Results:**
- ✅ All buttons are keyboard accessible
- ✅ Focus indicators are visible
- ✅ "Return to course" button can be activated with Enter
- ✅ Tab order is logical

### Accessibility Test 2: Screen Reader
**Steps:**
1. Enable screen reader (NVDA, JAWS, or VoiceOver)
2. Navigate through quiz

**Expected Results:**
- ✅ Passage labels are announced correctly
- ✅ "Return to course" button is announced
- ✅ Dropdown options are announced
- ✅ Form labels are associated correctly

---

## Testing Checklist

### Pre-Release Checklist
- [ ] All Feature Tests passed
- [ ] All Integration Tests passed
- [ ] All Regression Tests passed
- [ ] Tested on at least 3 browsers
- [ ] No JavaScript console errors
- [ ] No PHP errors or warnings
- [ ] CodeQL security scan passed
- [ ] Documentation updated
- [ ] CHANGELOG updated

### Known Issues
Document any issues found during testing:
1. _[None identified during initial testing]_

### Browser-Specific Issues
Document any browser-specific issues:
1. _[None identified during initial testing]_

---

## Rollback Procedure

If critical issues are found:
1. Deactivate plugin
2. Restore backup from v2.13
3. Reactivate plugin
4. Report issues to development team

All data structures are backward compatible, so rollback should be safe.

---

## Support Information

If you encounter issues during testing:
1. Check browser console for JavaScript errors
2. Check WordPress debug log for PHP errors
3. Verify test data is set up correctly
4. Try with default WordPress theme (to rule out theme conflicts)
5. Disable other plugins (to rule out plugin conflicts)

For v2.14 specific issues:
- Return to course: Check that quiz is linked to a course
- Passage labels: Verify questions have reading_text_id set
- True/False dropdown: Check browser console for JavaScript errors
